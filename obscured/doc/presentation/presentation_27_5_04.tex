\documentclass{article}
\usepackage{/home/jeroen/studie/dw/graphs/graphs}
\usepackage{amsfonts, amssymb}
\frenchspacing
\begin{document}

\newcommand{\qed}{$\blacksquare$}
\newcommand{\bs}{\begin{small}}
\newcommand{\es}{\end{small}}
\newcommand{\bS}{\begin{tiny}}
\newcommand{\eS}{\end{tiny}}
\newcommand{\monoit}[1]{\texttt{\textit{#1}}}

\section*{Automata}
Automatic sequences are connected in a fundamental way with substitutions of
\emph{constant length}.

\paragraph{Some definitions}
A finite automaton is a 5-tuple $A = (\mathcal{S}, \Delta, \delta, I, F)$
in which:\\
- $\mathcal{S}$ is the finite set of states.\\
- $\Delta$ is the finite alphabet of labels.\\
- $\delta \subseteq \mathcal{S} \times \Delta \times \mathcal{S}$ is the 
collection of transitions.\\
- $I \subseteq \mathcal{S}$ is the collection of initial states.\\
- $F \subseteq \mathcal{S}$ is the collection of final states.\\
\\
A finite automaton is represented by a directed graph with a set of vertices
$\mathcal{S}$ called \emph{states}, a set of edges $\delta$ called 
\emph{transitions}
and specially marked subsets of states $I$ and $F$, being the initial and final
states.\\
For our purposes, we will restrict ourselves to automata that have
$F = \mathcal{S}$ as the set of final states, so we will leave this notion
out unless stated otherwise. The states in $I$ are marked with a $\Uparrow$.\\
\\
An automaton is called finite if $\mathcal{S}$ is finite.\\
\\
An automaton is called deterministic if the following two conditions hold:\\
- $\exists (p \in I) \forall (q  \in \mathcal{S})
\{q = p \lor q \notin I\}$\\
- $\forall (p \in \mathcal{S}) \forall (a \in \Delta)
\forall (q \in \mathcal{S}) \forall (r \in \mathcal{S})
\{(p, a, q) \in \delta \land (p, a, r) \in \delta \Rightarrow q = r\}$.\\
In other words:\\
- There must be one and only one initial state.\\
- There can be no branches with the same label coming from the same state,
  going to different states.\\
% Picture of non-deterministic automaton. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$}
  \roundnode{s2}(0, 0) \nodetext{s2}(0, 0){$b$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \diredge{s1}{s2} \edgetext{s1}{s2}{0}

  \freetext(-2, -0.7){$\Uparrow$}
  \freetext(-2.5, -1.2){non-deterministic}
\end{graph}
%}}}1
% Picture of deterministic automaton. {{{1
\begin{graph}(0, 3)(-9, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$}
  \roundnode{s2}(0, 0) \nodetext{s2}(0, 0){$b$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \diredge{s1}{s2} \edgetext{s1}{s2}{1}

  \freetext(-2, -0.7){$\Uparrow$}
  \freetext(-2.5, -1.2){deterministic}
\end{graph}
%}}}1
\\
An automaton is complete (or total) if the following condition holds:\\
- $\forall (p \in \mathcal{S}) \forall (a \in \Delta)
\exists (q \in \mathcal{S}) \{(p, a, q) \in \delta\}$\\
In other words: Each state must have all outgoing branches from $\delta$.\\
% Picture of non-complete automaton. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$}
  \roundnode{s2}(0, 0) \nodetext{s2}(0, 0){$b$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \diredge{s1}{s2} \edgetext{s1}{s2}{1}

  \freetext(-2, -0.7){$\Uparrow$}
  \freetext(-2.5, -1.2){non-complete}
\end{graph}
%}}}1
% Picture of complete automaton. {{{1
\begin{graph}(0, 3)(-9, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$}
  \roundnode{s2}(0, 0) \nodetext{s2}(0, 0){$b$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \dirloopedge{s2}{50}(1, 0) \freetext(1.6, 0){0,1}
  \diredge{s1}{s2} \edgetext{s1}{s2}{1}

  \freetext(-2, -0.7){$\Uparrow$}
  \freetext(-2.5, -1.2){complete}
\end{graph}
%}}}1

\paragraph{The $k$-automaton}
The $k$-automaton (not a 2-tape automaton or transducer, as stated in the
book \cite{F1}, but rather a Moore automaton) is a finite, deterministic and 
complete automaton, expanded with an output function or exit map.\\
\\
Take $k \in \mathbb{N} \ge 2$. Denote by\\
$\mathcal{S}$: A finite set of states. There is a unique 
$\iota \in \mathcal{S}$ called the initial state.\\
$\Delta$: $k$ labels indicated by integers from 0 to $k - 1$.\\
$\mathcal{L}$: The input language, in this case always $\Delta^*$.\\
$\delta$: The $k$ transitions per state. Hence 
$\delta \cong \mathcal{S} \times \Delta$.\\
$Y$: The output alphabet. We usually take $Y = \mathcal{S}$.\\
$\varphi$: A function from $\mathcal{S}$ to $Y$ called the exit map. We
           usually take $\varphi =$ Id.\\
\\
So a $k$-automaton is an automaton with states $\mathcal{S}$. Each state has
$k$ outgoing branches, labelled $0, ..., k - 1$. Furthermore, there is only
one initial state. Each state also has an output function.

\paragraph{Example}
\begin{eqnarray*}
&&k = 2\\
&&\mathcal{S} = \{a, b\}, \iota \in \mathcal{S} = \{a\}\\
&&\Delta = \{0, 1\}\\
&&\sigma:\{a, b\} \rightarrow \{a, b\}^*, \sigma(a) \rightarrow ab,
\sigma(b) \rightarrow ab\\
&&Y = \{a, b\}\\
&&\varphi: \varphi(a) \rightarrow a, \varphi(b) \rightarrow b
\end{eqnarray*}
\\
This substitution (of constant length 2) has only one fixed point:\\
\\
\monoit{u = ababababababababababababababababababababababababab...}
$= (ab)^\mathbb{N}$\\
\\
We can say: $u_n = a$ if and only if $n \mathrm{\ mod\ } 2 = 0$, and:
$u_n = b$ if and only if $n \mathrm{\ mod\ } 2 = 1$, so we need an automaton
that ends in state $a$ if $u_n$ is at an even position and in state $b$ if
$u_n$ is in an odd position. Such an automaton is given by\\
% Picture of mod-2 automaton. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$}
  \roundnode{s2}(0, 0)  \nodetext{s2}(0, 0){$b$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \dirbow{s1}{s2}{.2} \bowtext{s1}{s2}{.2}{1}
  \dirbow{s2}{s1}{.2} \bowtext{s2}{s1}{.2}{0}
  \dirloopedge{s2}{50}(1, 0) \freetext(1.6, 0){1}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
If we take the base 2 expansion of an integer (let us say the decimal
number 22) and feed it to the automaton above, the automaton receives the
digits 10110 and will be in state $a$ when it starts.\\
After reading the first digit, it will be in state $b$, after reading the
second one the automaton will be in state $a$. The table below shows the path
taken:\\
\\
\begin{tabular}{c|c|c|l}
state & transition & next state & tail\\
\hline
$i=a$ & 1 & $b$ & 0110\\
$b$   & 0 & $a$ & 110\\
$a$   & 1 & $b$ & 10\\
$b$   & 1 & $b$ & 0\\
$b$   & 0 & $a$ &\\
$a$   &   &   &
\end{tabular}\\
\\
It will be clear that this automaton generates the string $(ab)^n$, for it
maps any integer $n$ to $a$ if and only if $n \mathrm{\ mod\ } 2 = 0$ and to
$b$ if and only if $n \mathrm{\ mod\ } 2 = 1$. This is obvious, since the
automaton will always reach state $a$ if the last digit is 0 and state $b$ 
if it is 1.\\
\\
If we feed the sequence 0, 1, 10, 11, 100, ..., $\infty$ to the automaton,
we will get the sequence $u$. $\square$\\
\\
The example shows a duality between automata and words invariant under 
substitutions. We shall study this duality in the sequel.\\
\\
Remark on $\Delta$. Normally, an automaton accepts a string if it is in
a final state when the end of its input is read. In this case, the final state
results (via $\varphi$) in an output. The output will code a number
$n \in \mathbb{N}$ which will result in the $n$--th letter of the fixed point
if the base $k$ expansion of $n$ is fed to the automaton. Feeding the base
$k$ expansion of $n = 0, 1, 2, ...$ will result in the fixed point.

\paragraph{Letter-to-letter projection} Consider a map from a finite alphabet
$\mathcal{A}$ to an other finite alphabet $\mathcal{B}$. This map extends in
a natural way (by concatenation) to a map from
$\mathcal{A}^* \cup \mathcal{A}^\mathbb{N}$ to
$\mathcal{B}^* \cup \mathcal{B}^\mathbb{N}$.

\paragraph{$k$-automaticity} A sequence $u$ is $k$-automatic if and only if
$u$ is the image by a letter-to-letter projection of a fixed point of a
substitution of constant length $k$. So a sequence $(u_n)_{n \in \mathbb{N}}$
with values in $Y$ is $k$-automatic if it can be generated by a $k$-automaton
as follows:\\
- Let $\sum_{i=0}^j n_i k^i (n_j \neq 0)$ be the base $k$ expansion of an
  integer $n$.\\
- Initialise the automaton and feed it with the sequence $n_0, n_1, ..., n_j$,
  note that the least significant digit is read first.\\
- Put $u_n = \varphi(a(n))$, if the automaton is in state $a(n)$ after all 
letters have been read.\\
\\
The definition above assumed the automaton was fed in \emph{reverse reading}.
We can also feed the digits to the automaton in the normal order (starting with
the most significant bit). This is called \emph{direct reading}.\\
Note that we use automata to generate a sequence, not to recognise one as is
usual in computer science.

\paragraph{Theorem} \emph{If we take a $k$-automatic sequence and apply some
homomorphism to it, it will remain $k$-automatic.}

\paragraph{Proof} Let $v$ be the image of a letter-to-letter
projection $p: \mathcal{A} \rightarrow \mathcal{B}$ of the fixed point
$u = (u(n))_{n \in \mathbb{N}} \in \mathcal{A}^\mathbb{N}$ of a substitution
$\sigma$ of constant length $k$ defined on the alphabet $\mathcal{A}$, then
$v$ is generated by the same automaton that generated $u$, but with the
projection $p$ as output function. \qed

\paragraph{Example\\}
% Picture of mod-2 automaton with exit map. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$/0}
  \roundnode{s2}(0, 0)  \nodetext{s2}(0, 0){$b$/1}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \dirbow{s1}{s2}{.2} \bowtext{s1}{s2}{.2}{1}
  \dirbow{s2}{s1}{.2} \bowtext{s2}{s1}{.2}{0}
  \dirloopedge{s2}{50}(1, 0) \freetext(1.6, 0){1}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
This automaton has an output alphabet $Y$ different from $\mathcal{S}$. To
say: $Y = \{0, 1\}$ and we do not use Id$_{\{a, b\}}$ as the exit map, but
$\varphi(a) \rightarrow 0, \varphi(b) \rightarrow 1$. This is denoted by
$a/0, b/1$ in the automaton.

\paragraph{Theorem} \emph{A sequence $u$ is $k$-automatic in direct reading if 
and only if $u$ is the image of a letter-to-letter projection of a fixed point 
of a substitution of constant length $k$.}

\paragraph{Proof}
$\Leftarrow$ Let $u$ be a fixed point of a substitution $\sigma$ of length
$k$ over the alphabet $\mathcal{A}$. Define
$\sigma_i: \mathcal{A} \rightarrow \mathcal{A}$, which sends letter $a$ to the
($i$ + 1)--th letter of $\sigma(a)$. Hence
$\sigma = \sigma_0 ... \sigma_{k - 1}$.\\
We can now construct an automaton in direct reading. Let $\mathcal{S = A}$ and
$\delta = \sigma_i$. We make a transition from $a$ to $b$ labelled $i$ if $b$
occurs in $\sigma(a)$ at position $i + 1$. Take $\iota \in \mathcal{S} = u_0$
as the initial state. Take $\varphi =$ Id.\\
Let $\sum_{i = 0}^j n_i k^i$ be the $k$-adic expansion of $n$. We start from 
$u(0)$, then go to the $(n_t + 1)$--th letter of $\sigma(u(0))$, denoted by 
$a_1$, then go to the $(n_{t - 1} + 1)$--th letter of $\sigma(a_1)$, which is 
also the $(kn_t + n_{t - 1} + 1)$--th letter of $\sigma^2(u(0))$ and so on.
After $t$ steps we arrive at the $(n + 1)$--th letter of $\sigma^{t + 1}(u_0)$,
which is $u(n)$. We have constructed an automaton that generates the sequence 
$u$ in direct reading.\\
$\Rightarrow$ Let $u$ be a sequence generated by a $k$-automaton in direct
reading. Let $\mathcal{S}$ be the set of states of the automaton and let
$f_0, ..., f_{k - 1}$ be the transition maps (i.e. the state we reach if we
follow transition $0, 1, ..., k - 1$ from a certain state). Define the 
substitution of constant length $\sigma = f_0 ... f_{k - 1}$ over 
$\mathcal{S}$. Let $v$ be the fixed point of $\sigma$ beginning with the 
initial state $i$. It is easily checked that the sequence $u$ is the image by 
the output function $\varphi$ of the fixed point $v$. \qed\\
\\
Note that we map the initial state onto itself with label 0 by default. This
is to avoid problems with leading zeros in the input word.\\
Suppose $\mathcal{A}$ is an alphabet with $|\mathcal{A}| = k$. Let 
$\phi: \mathcal{A} \rightarrow \{0, 1, ..., k - 1\}$ be a bijection. In the
sequel we use a bijection between $k$-letter substitutions 
$\sigma: \mathcal{A} \rightarrow \mathcal{A}$ and $k$-automata with states 
$\mathcal{A}$ by having an edge labelled $\phi(i)$ from state $a$ to state $b$ 
if $i$ is the $(i + 1)$-th letter of $\sigma(a)$. By default we assume that
$a$ is the initial state, $\phi(a) = 0$ and $\sigma(a)$ starts with $a$ to 
avoid problems with leading zeroes in the input word.

\section*{The Cantor sequence}
The Cantor sequence is defined as the invariant word under the substitution: 
$\sigma: \sigma(a) \rightarrow aba, \sigma(b) \rightarrow bbb$. With $a$ as the
initial letter, it gives the following fixed point:\\
\\
\monoit{u = ababbbababbbbbbbbbababbbababbbbbbbbbbbbbbbbbbbbbbbbbb...}\\
\\
The following automaton is associated with this
substitution:\\
% Picture of cantor automaton. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$}
  \roundnode{s2}(0, 0)  \nodetext{s2}(0, 0){$b$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0,2}
  \diredge{s1}{s2} \edgetext{s1}{s2}{1}
  \dirloopedge{s2}{50}(1, 0) \freetext(1.6, 0){0,1,2}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
Let us denote $\mathbb{C}_a$ as the set of integers $n$ such that the
$(n + 1)$--th letter of the Cantor sequence is $a$.\\
The automaton above suggests that $\mathcal{C}_a$ is given by:
\begin{displaymath}
  \mathbb{C}_a = \Big\{n \in \mathbb{N}; n = \sum_{i \ge 0} n_i3^i,
  \mathrm{\ with\ } \forall(i \ge 0), n_i \in \{0, 2\}\Big\}
\end{displaymath}

\paragraph{Proof} Let $n = \sum_{i = 0}^t n_i 3^i$ with $n_i \in \{0, 1, 2\}$
for all $i$. Consider the mapping $\tau: \{0, 1, ..., t\} \rightarrow \{a, b\}$
by $\tau(j) = u(\sum_{i = 0}^j n_i 3^i)$. By definition of $\sigma$ we have 
$\tau(j + 1) = a$ if and only if $\tau(j) = a$ and $n_{j + 1} \in \{0, 2\}$.
\qed\\
Compare the Cantor fractal with the Cantor word:\\
% Picture of the Cantor set. {{{1
\\
\verb#   0      0.1       0.2      1  |   0     0.1         0.2     1#\\
\verb#---------------------------------------------------------------#\\
\verb#   ===========================  |               #\monoit{a}\\
\verb#   =========         =========  |      #\monoit{a} { } { } { } { } { } { }\monoit{b} { } { } { } { } { } { }\monoit{a}\\
\verb#   ===   ===         ===   ===  |   #\monoit{a { }b { }a { }b { }b { }b { }a { }b { }a}\\
\verb#   = =   = =         = =   = =  |  #\monoit{ababbbababbbbbbbbbababbbaba}\\
\\
%}}}1

\section*{The kernel of a sequence}
\paragraph{$k$-kernel} Let $N_k(u)$ be the set of subsequences of the sequence
$(u(n))_{n \in \mathbb{N}}$ defined by:
\begin{displaymath}
N_k(u) = \{(u(k^ln + r))_{n \in \mathbb{N}}; l \ge 0; 0 \le r \le k^l - 1\}.
\end{displaymath}

\paragraph{Theorem} \emph{A sequence $u \in \mathcal{A}^\mathbb{N}$ is 
$k$-automatic in reverse reading if and only if the $k$-kernel $N_k(u)$ of the 
sequence $u$ is finite.}

\paragraph{Proof}
$\Leftarrow$ Suppose the $k$-kernel of a sequence $u$ is finite. Let
$u = a_1, ..., a_d$ be the sequences of $N_k(u)$. Take
$\mathcal{S} = \{a_1, ..., a_d\}$. Define for any integer $r \in [0, k - 1]$, 
the map $r : \mathcal{S} \rightarrow \mathcal{S}$ which associates any state 
$a_i$ with $r \cdot a_i$ in bijection with the sequence of the $k$-kernel
$(a_i(kn + r))_{n \in \mathbb{N}}$. So $r \cdot a_i$ is the state which will be
reached if we follow label $r$ from state $a_i$. Let
$n = \sum_{i = 0}^j n_i k^i$ be the base $k$ expansion of an integer $n$, with
$n_i \in [0, k - 1], n_j \ne 0$.  We define the map $n$ from
$\mathcal{S}$ to $\mathcal{S}$ by $n(a_i) = n_j(n_{j - 1}( ... (n_0(a_i))))$,
if $n \ne 0$, otherwise the map 0 is the identity.\\
It follows by induction that $n \cdot a_i$ is in bijection with
$(u(k^{j + 1} l + n))_{l \in \mathbb{N}}$. Hence if $n \cdot a_1 = m \cdot a_1$
then $u(n) = u(m)$, by considering the first term of the two corresponding
subsequences. Now we can define the map $\varphi$ as output function, which
associates $a_i$ with $u(n)$ if and only if $n \cdot a_1 = a_i$. Therefore the
sequence is generated by the automaton in reverse reading.\\
$\Rightarrow$ Suppose $A$ is a finite $k$-automaton with initial state $i$
which generates $u$. The subsequence $(u(k^ln + r))_{n \ge 0}$, where
$l \ge 0$ and $0 \le r < k^l$, is generated by $A$ with the initial state
$\overline{r} \cdot i$, where $\overline{r}$ is the word of $k$ letters
obtained by concatenating in front of the base $k$ expansion of $r$ as many
zeros as necessary. Because $A$ has a finite number of states, there is only a
finite set of subsequences. \qed\\
\\
The proof above gives a method for constructing a $k$-automaton in reverse
reading. Take the $k$-kernel of a fixed point and let $\mathcal{S}$ be in
bijection with the sequences. Now add transitions from state $a$ to $b$
labelled $i$ if the sequence associated with $b$ is a subsequence of the
sequence associated with $a$ defined as $(a_i(kn + r))_{n \in \mathbb{N}}$.
Make one of the fixed points the initial state and make all states that have
incoming transitions (starting from that initial state) final states.

\paragraph{Example}
The fixed point of the substitution $a \rightarrow ab$, $b \rightarrow ab$,
which is $abababab...$ has the following 2-kernel.\\
\\
\monoit{ababababababababababababababababababa...}
$= (ab)^\mathbb{N} = (u(2^0 n + 0))_{n \in \mathbb{N}}$\\
\monoit{aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa...}
$= a^\mathbb{N} = (u(2^1 n + 0))_{n \in \mathbb{N}}$\\
\monoit{bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb...}
$= b^\mathbb{N} = (u(2^1 n + 1))_{n \in \mathbb{N}}$\\
\\
By taking $l = 0$, we find $(2^0 n + 0)_{n \in \mathbb{N}}$. For $l = 1$ we
obtain two sequences: $(2_1 n + 0)_{n \in \mathbb{N}}$ and
$(2_1 n + 1)_{n \in \mathbb{N}}$.\\
This is the complete $k$-kernel, because all step sizes are of the form
$k^l$. So taking larger step sizes will only yield the second or third
sequence again.\\
% Picture of mod-2 automaton in reverse reading. {{{1
\begin{graph}(0, 3)(-4, -0.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-1, 0) \nodetext{s1}(0, 0){$\iota$}
  \roundnode{s2}(-2, 1.5)
    \nodetext{s2}(0, -0.22){\circle{0.8}} \nodetext{s2}(0, 0){$a$}
  \roundnode{s3}(0, 1.5)
    \nodetext{s3}(0, -0.22){\circle{0.8}} \nodetext{s3}(0, 0){$b$}

  \diredge{s1}{s2} \edgetext{s1}{s2}{0}
  \diredge{s1}{s3} \edgetext{s1}{s3}{1}
  \dirloopedge{s2}{50}(-1, 0) \freetext(-3.6, 1.5){0,1}
  \dirloopedge{s3}{50}(1, 0) \freetext(1.6, 1.5){0,1}

  \freetext(-1, -0.7){$\Uparrow$}
\end{graph}
%}}}1
% Picture of mod-2 automaton in direct reading again. {{{1
\begin{graph}(0, 3)(-10, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$}
  \roundnode{s2}(0, 0)  \nodetext{s2}(0, 0){$b$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \dirbow{s1}{s2}{.2} \bowtext{s1}{s2}{.2}{1}
  \dirbow{s2}{s1}{.2} \bowtext{s2}{s1}{.2}{0}
  \dirloopedge{s2}{50}(1, 0) \freetext(1.6, 0){1}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
\\
The left figure is the automaton that generates $u$ in reverse reading. Note 
that $\iota$ is not a final state, hence $\mathcal{S} \ne \mathcal{A}$. The 
states that are final states are marked with an internal circle.\\
The right figure is the automaton that generates $u$ in direct reading. Hence
the generating automaton can be essentially different.

\paragraph{Theorem} \emph{A sequence is $k$-automatic in direct reading if and 
only if it is $k$-automatic in reverse reading.}

\paragraph{Proof} From the proofs above, we can conclude that we can construct 
a $k$-automaton in direct reading from a substitution of constant length which 
generates $u$.  This in turn defines a finite $k$-kernel from which we can 
construct an automaton in reverse reading. This proof also holds the other way 
around. \qed

\paragraph{Example} The kernel of the Cantor sequence is given by
\\
\monoit{ababbbababbbbbbbbbababbbababbbbbbbbbbbbbb...}
$(l = 0) \Rightarrow u(3^0 n + 0)_{n \in \mathbb{N}}$\\
\monoit{bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb...}
$(l = 1) \Rightarrow u(3^1 n + 1)_{n \in \mathbb{N}}$\\

\section*{The Thue-Morse sequence}
Let us look at the following substitution: $\sigma: \sigma(a) \rightarrow ab$,
$\sigma(b) \rightarrow ba$. With $a$ as the initial letter, it gives the
following fixed point:\\
\\
\monoit{u = abbabaabbaababbabaababbaabbabaabbaababbaabbabaababbab...}\\
\\
The following automaton is associated with this
substitution:\\
% Picture of Thue-Morse automaton. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$}
  \roundnode{s2}(0, 0)  \nodetext{s2}(0, 0){$b$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \dirbow{s1}{s2}{.2} \bowtext{s1}{s2}{.2}{1}
  \dirbow{s2}{s1}{.2} \bowtext{s2}{s1}{.2}{1}
  \dirloopedge{s2}{50}(1, 0) \freetext(1.6, 0){0}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
Note that the final state is $a$ when the number of ones in the input word
is even, and $b$ otherwise. Hence this automaton generates $u$ both in direct
and in reverse reading.

The automaton above suggests an interesting mapping from $\mathbb{N}$ to
$u(n)$. 
\begin{eqnarray*}
\mathbb{N}_a = \{0, 3, 5, 6, 9, 10, 12, 15, ...\}\\
\mathbb{N}_b = \{1, 2, 4, 7, 8, 11, 13, 14, ...\}
\end{eqnarray*}
Let us define $S_2(n)$ as the sum of the dyadic digits:
\begin{displaymath}
S_2(n) = \sum_{i \ge 0}n_i,\mathrm{\ if\ }
n = \sum_{i \ge 0}n_i2^i, n_i \in \{0, 1\}
\end{displaymath}
The two disjunct sets $\mathbb{N}_a$ and $\mathbb{N}_b$ are defined by:
\begin{eqnarray*}
x \in \mathbb{N}_a &\Leftrightarrow& S_2(n) \mathrm{\ is\ even}\\
x \in \mathbb{N}_b &\Leftrightarrow& S_2(n) \mathrm{\ is\ odd}
\end{eqnarray*}
This is obvious from the automaton.\\
\\
The 2-kernel of this sequence is:\\
\\
\monoit{abbabaabbaababbabaababbaabbabaabbaababbaabbab...} $(l = 0)$\\
\monoit{baababbaabbabaababbabaabbaababbaabbabaabbaaba...} $(l = 1, r = 1)$\\
\\
So the 2-kernel consists of both fixed points.

\section*{The Rudin-Shapiro sequence}
Define $u(n) = (-1)^{r_n}$, where $r_n$ is the number of occurrences of
consecutive `11' in the binary representation of $n$. Therefore it does not 
matter if we apply direct or reverse reading. The corresponding automaton is
given by\\
% Picture of Rudin-Shapiro automaton. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){\bs$a$/+1\es}
  \roundnode{s2}(0, 0)  \nodetext{s2}(0, 0){\bs$b$/+1\es}
  \roundnode{s3}(2, 0)  \nodetext{s3}(0, 0){\bs$c$/-1\es}
  \roundnode{s4}(4, 0)  \nodetext{s4}(0, 0){\bs$d$/-1\es}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \dirbow{s1}{s2}{0.2} \bowtext{s1}{s2}{0.2}{1}
  \dirbow{s2}{s1}{0.2} \bowtext{s2}{s1}{0.2}{0}
  \dirbow{s2}{s3}{0.2} \bowtext{s2}{s3}{0.2}{1}
  \dirbow{s3}{s4}{0.2} \bowtext{s3}{s4}{0.2}{0}
  \dirbow{s3}{s2}{0.2} \bowtext{s3}{s2}{0.2}{1}
  \dirloopedge{s4}{50}(1, 0) \freetext(5.6, 0){0}
  \dirbow{s4}{s3}{0.2} \bowtext{s4}{s3}{0.2}{1}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
Thus the Rundin-Shapiro sequence is the invariant word under the substitution
$a \rightarrow ab, b \rightarrow ac, c \rightarrow db, d \rightarrow dc$
starting with $a$ and with the indicated output function.

\section*{The Baum-Sweet sequence}
The Baum-Sweet sequence $(u_n)_{n \in \mathbb{N}}$ with values in the alphabet
$\{0, 1\}$ is defined by:\\
\vbox{\begin{eqnarray*}
u_n &=& 0 \mathrm{\ if\ the\ dyadic\ development\ of\ } n
          \mathrm{\ contains\ at\ least\ one\ odd\ string\ of\ 0's},\\
    &=& 1 \mathrm{\ if\ not.}
\end{eqnarray*}}
Obviously the automaton does not depend on the way of reading. It is given by\\
\\
% Picture of Baum-Sweet automaton. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$/1}
  \roundnode{s2}(0, 0)  \nodetext{s2}(0, 0){$b$/1}
  \roundnode{s3}(2, 0)  \nodetext{s3}(0, 0){$c$/0}
  \roundnode{s4}(4, 0)  \nodetext{s4}(0, 0){$d$/0}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \diredge{s1}{s2} \edgetext{s1}{s2}{1}
  \dirbow{s2}{s3}{0.2} \bowtext{s2}{s3}{0.2}{0}
  \dirloopedge{s2}{50}(0, 1) \freetext(0, 1.6){1}
  \dirbow{s3}{s2}{0.2} \bowtext{s3}{s2}{0.2}{0}
  \diredge{s3}{s4} \edgetext{s3}{s4}{1}
  \dirloopedge{s4}{50}(1, 0) \freetext(5.6, 0){0,1}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
It will be clear that the automaton above generates the sequence when we use
$\varphi(a) = \varphi(b) = 1$ and $\varphi(c) = \varphi(d) = 0$.\\
The automaton in turn gives the substitution rules:
$\sigma(a) \rightarrow ab, \sigma(b) \rightarrow cb$,
$\sigma(c) \rightarrow bd, \sigma(d) \rightarrow dd$.

\section*{A divisibility automaton}
Given two integers $k$ and $d$ greater or equal to two, can an automaton 
decide only from its $k$-adic development whether any $n \in \mathbb{N}$ is
divisible by $d$? Let $\mathcal{S} = \{0, 1, ..., d - 1\}$ and let $u$ be the
periodic sequence:
\begin{displaymath}
  u = 01...(d - 1)01...(d - 1)... .
\end{displaymath}
We need to construct a $k$-automaton that generates $u$. To do this we need to
find a substitution $\sigma$ of constant length $k$ such that $u$ is the fixed
point of $\sigma$. We can do that by cutting $u$ in words of length $k$ and
rewriting $u$ as
$u = \sigma(0)\sigma(1)...\sigma(d - 1)\sigma(0)\sigma(1)...\sigma(d - 1)...$.\\
\\
For the case $k = 2, d = 5$, the substitution looks as follows:\\
\vbox{\begin{eqnarray*}
  \sigma(0) &\rightarrow& 01\\
  \sigma(1) &\rightarrow& 23\\
  \sigma(2) &\rightarrow& 40\\
  \sigma(3) &\rightarrow& 12\\
  \sigma(4) &\rightarrow& 34
\end{eqnarray*}}
This gives the following automaton:\\
% Picture of mod-5 automaton. {{{1
\begin{graph}(0, 3)(-4, -0.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$0$}
  \roundnode{s2}(-1, 1.5) \nodetext{s2}(0, 0){$1$}
  \roundnode{s3}(0, 0) \nodetext{s3}(0, 0){$2$}
  \roundnode{s4}(1, 1.5) \nodetext{s4}(0, 0){$3$}
  \roundnode{s5}(2, 0) \nodetext{s5}(0, 0){$4$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \diredge{s1}{s2} \edgetext{s1}{s2}{1}
  \diredge{s2}{s3} \edgetext{s2}{s3}{0}
  \dirbow{s2}{s4}{0.2} \bowtext{s2}{s4}{0.2}{1}
  \diredge{s3}{s5} \edgetext{s3}{s5}{0}
  \diredge{s3}{s1} \edgetext{s3}{s1}{1}
  \dirbow{s4}{s2}{0.2} \bowtext{s4}{s2}{0.2}{0}
  \diredge{s4}{s3} \edgetext{s4}{s3}{1}
  \diredge{s5}{s4} \edgetext{s5}{s4}{0}
  \dirloopedge{s5}{50}(1, 0) \freetext(3.6, 0){1}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
\\
Thus $n = (n_t n_{t - 1} ... n_0)_2$ is divisible by 5 if and only if 0 is
the final state after the consecutive transitions $n_t, n_{t - 1}, ... n_0$.
Moreover, if j is the final state, then j is the rest of $n$ after dividing
by 5.

\section*{Sturmian sequences}
\paragraph{Regular languages}
A language $\mathcal{L}$ is called regular if we can make a finite automaton
that accepts $\mathcal{L}$. Note that we do not talk about $k$-automata, but
about automata in general.

\paragraph{The pumping lemma for regular languages}
\paragraph{Theorem} \emph{Let $\mathcal{L}$ be a regular language. Then there 
exists an $n \in \mathbb{N}, n \ge 1$, such that for all $z \in \mathcal{L}$, 
if $|z| > n$ there are words $r, s, t$ such that:\\
- $z = rst$\\
- $s \ne \epsilon$\\
- $|rs| \le n$\\
- For all $i \in \mathbb{N}, r s^i t \in \mathcal{L}$}

\paragraph{Proof}
Let $A = (\mathcal{S}, \Delta, \delta, I, F)$ be a finite automaton. Let
$K = \mathcal{L}(A)$, let $n = |\mathcal{S}|$ and let trans be a sequence of
transitions. We may assume $\mathcal{S} \ne \epsilon$, and therefore
$n \ge 1$.\\
Take any $z \in K$ with $m = |z| > n$. If such a word does not exist, we are
finished. We look at a path $\pi$ of $z$ in $A$, say
$\pi = (q_0, a_1, q_1)(q_1, a_2, q_2)...(q_{m - 1}, a_m, q_m)$ with
$q_0 \in I$ and $q_m \in F$, so $z = \mathrm{trans}(\pi) = a_1a_2...a_m$.\\
Because $m > n$, there exist $k$ and $j$ with $0 \le k < j \le n$ and
$q_k = q_j$.\\
We now split the path into three parts; $\pi = \pi_1 \pi_2 \pi_3$, with
\begin{eqnarray*}
  \pi_1 &=& (q_0, a_1, q_1) ... (q_{k - 1}, a_k, q_k),\\
  \pi_2 &=& (q_k, a_{k + 1}, q_{k + 1}) ... (q_{j - 1}, a_j, q_j),\\
  \pi_3 &=& (q_j, a_{j + 1}, q_{j + 1}) ... (q_{m - 1}, a_m, q_m).
\end{eqnarray*}
Let $r = \mathrm{trans}(\pi_1), s = \mathrm{trans}(\pi_2),
     t = \mathrm{trans}(\pi_3)$\\
Because $\pi_2$ is a cycle in the automaton, from $q_k$ to $q_j = q_k$, there
exists for all $i \in \mathbb{N}$ a path $\pi_1 \pi_2^i \pi_3$ from $q_0$ to
$q_m$. So $\mathrm{trans}(\pi_1 \pi_2^i \pi_3) \in K$. Because trans is a
homomorphism, we can say:  $\mathrm{trans}(\pi_1 \pi_2^i \pi_3) =
\mathrm{trans}(\pi_1) \mathrm{trans}(\pi_2)^i \mathrm{trans}(\pi_3) = r s^i t$.
So $r s^i t \in K$ for all $i \in \mathbb{N}$.\\
Note that $|s| = |\mathrm{trans}(\pi_2)| = j - k > 0$, so $s \ne \epsilon$
and also $|rs| = |\mathrm{trans}(\pi_1 \pi_2)| = j \le n$. \qed\\
% Picture of general automaton. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){\bs$q_0$\es}
  \roundnode{s2}(0, 0) \nodetext{s2}(0, 0){\bS$q_k=q_j$\eS}
  \roundnode{s3}(2, 0)
    \nodetext{s3}(0, -0.22){\circle{0.8}} \nodetext{s3}(0, 0){\bs$q_m$\es}

  \diredge{s1}{s2} \edgetext{s1}{s2}{$r$}
  \dirloopedge{s2}{50}(0, 1) \freetext(0, 1.6){$s$}
  \diredge{s2}{s3} \edgetext{s2}{s3}{$t$}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
We can use the pumping lemma to prove that a certain language is not regular.

\paragraph{Theorem} \emph{$\mathcal{L} = \{0^m1^m | m \in \mathbb{N}\}$ is not 
regular.}

\paragraph{Proof}
Suppose $\mathcal{L}$ is regular. We can then find a number $n \ge 1$ that
conforms to the pumping lemma.\\
Consider the word $z = 0^n 1^n$. We see that $z \in \mathcal{L}$ and
$|z| = 2n > n$. So we can write $z = r s t$ with $|r s| \le n$ and
$s \ne \epsilon$. Hence $rs$ consists of only zeros, so $s = 0^k$ for a certain
$k$. Now take $x = 0$. According to the pumping lemma
$r s^0 t = r t \in \mathcal{L}$, but $r t = 0^{n - k} 1^n$ with $n - k < n$, so
$rt \notin \mathcal{L}$. This is a contradiction, so our assumption was false.
$\mathcal{L}$ is not regular. \qed

\paragraph{Theorem} \emph{If $u$ is a Sturmian sequence, the language 
$\mathcal{L}(u)$ is not regular.}

\paragraph{Proof}
Suppose $\mathcal{L}(u)$ is regular, then for any $x$ $r s^x t$ belongs to
$\mathcal{L}$. So $s^x$ belongs to $\mathcal{L}$. We know that any Sturmian
word of length $m|v|$ has $m|v|_1 = \delta$ with $\delta \in \{-1, 0 , 1\}$.
The frequency of 1 in $s^x$ is $|s|_1 / |s|$, so the density is
$\lim_{m \to \infty} \frac{m|s|_1 + \delta}{m|s|} \in \mathbb{Q}$. This is in
contradiction with Proposition 6.1.10 \cite{F2}. \qed

\section*{The Fibonacci sequence}
Up to now, we have only looked at substitutions of constant length, which had
the important property that the associated automaton accepted
$\Delta^*$. Now let us look at substitutions of non-constant
length. They will result in non-complete automata, and therefore will only
accept a subset of $\Delta^*$.\\
\\
The Fibonacci sequence is as follows: $\sigma: \sigma(a) \rightarrow ab,
\sigma(b) \rightarrow a$. With $a$ as the initial letter, it gives the
following fixed point:\\
\\
\monoit{u = abaababaabaababaababaabaababaabaababaababaabaababaaba...}\\
\\
The 2-kernel of this sequence contains the words:\\
\\
\monoit{abaababaabaababaababaabaababaabaababaababaabaababaaba...}\\
\\
\monoit{aabbaabbaaabaaabaaabbaabbaaabaaabaaabba...}\\
\monoit{baaabaaabbaabbaabbaaabaaabbaabbaabbaaab...}\\
\\
\monoit{ababaaaaaabababababa...}\\
\monoit{ababababababaaaaaaba...}\\
\monoit{bababababaaaabababab...}\\
\monoit{aaaabababababababaaa...}\\
\monoit{...}\\
\\
This suggests that the 2-kernel of this sequence is infinite. It is certainly
bigger than $(\mathrm{Card}(\mathcal{A}))^{\mathrm{Card}(\mathcal{A})}$, so
this sequence is not 2-automatic.\\
\\
This substitution suggests the following automaton is associated with this
substitution:\\
% Picture of Fibonacci automaton. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$}
  \roundnode{s2}(0, 0)  \nodetext{s2}(0, 0){$b$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0}
  \dirbow{s1}{s2}{.2} \bowtext{s1}{s2}{.2}{1}
  \dirbow{s2}{s1}{.2} \bowtext{s2}{s1}{.2}{0}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
Note that this is almost the same automaton that generates
$(ab)^{\mathbb{N}}$, it only lacks one branch.\\
We immediately see that this is not a $k$-automaton, for it is not total,
moreover, if we feed this automaton with the base 2 expansion of
$n \in \mathbb{N}$, it will halt (or crash) when we feed it a string which has
two consecutive ones as a substring.\\
However, our intuition is right, this is the automaton associated with the
Fibonacci sequence, but since it is not a $k$-automaton, we can not feed it
with the base $k$ expansion of an integer. We must find an other type of
expansion.\\
In this particular case we know which expansion to take, viz. the Fibonacci
expansion; in general this is not known.\\
\\
Let $(F_n)_{n \in \mathbb{N}}$ be the sequence of integers defined by $F_0 = 1,
F_1 = 2$ and for any integer $n > 1, F_{n + 1} = F_{n - 1} + F_n$.\\
\\
If $n = \sum_{i = 0}^k n_i F_i$ with $n_k = 1, n_i \in \{0, 1\}$ and 
$\forall (i < k) \{n_i n_{i + 1} = 0\}$, we say that 
Fib$(n) = n_k n_{k - 1} ... n_0 \in \{0, 1\}^{k + 1}$ is the
\emph{Fibonacci expansion} of the integer $n$.\\
\\
This gives the following mapping:\\ \vbox{
\begin{verbatim}
  0 = 0
  1 = 1
  2 = 10
  3 = 100
  4 = 101
  5 = 1000
   ...
\end{verbatim}}

\paragraph{Theorem} \emph{Every nonnegative integer $n$ can be written in a 
unique way as $n = \sum_{i \ge 0} n_i F_i$ with $n_i \in \{0, 1\}$ and
$\forall (i \ge 0) \{n_i n_{i + 1} = 0\}$}

\paragraph{Proof} By induction over $n$.\\
It is true for $n = 0$.\\
Suppose it holds for $n < F_k$.\\
If $F_k \le n < F_{k + 1}$ then by $F_{k + 1} = F_k + F_{k - 1}$ we have 
$n - F_k < F_{k - 1}$. Because we can write $n - F_k$ by our hypothesis as
$n - F_k = \sum_{i = 0}^{k - 2} n_i F_i$ with $n_i n_{i - 1} = 0$ for
$i = 1, ..., k - 2$, we can write $n = F_k + \sum_{i = 0}^{k - 2} n_i F_i$ 
such that there are no two consecutive ones.\\
\\
We still need to prove that the Fibonacci representation is unique.\\
Let $n \in \mathbb{N}$ be the smallest number for which there is more than one
representation. Choose $k$ such that $F_k \le n < F_{k + 1}$ and write
$n = n_k n_{k - 1} ... n_0$ (the standard representation) and
$n = n'_l n'_{l - 1} ... n'_0$ (another representation satisfying 
$n'_i n'_{i - 1} = 0$ for $i = 1, ..., k - 2$). Then $n_k = 1$ and $l \le k$.
If $n_k = n'_k$ then $n - F_k$ would have two distinct representations as well.
Hence $n'_k = 0$.
The maximum number of length $k - 1$ we can represent is 
$F_{k - 1} + F_{k - 3} + F_{k - 5} + ...$, which is equal to $F_{k - 1}$ and 
therefore smaller than $n$. \qed\\
\\
Since this system can be used to enumerate $n \in \mathbb{N}$ and it has the
property that no two ones succeed each other, this is the mapping we are
looking for.\\
\\
Put
\begin{eqnarray*}
  \mathbb{N}_a &=& \{n \in \mathbb{N}, \mathrm{Fib}(n) \in \{0, 1\}^* 0\} = 
                   \{0, 2, 3, 5, 7, 8, 10, 11, 13, 15, ...\}\\
  \mathbb{N}_b &=& \{n \in \mathbb{N}, \mathrm{Fib}(n) \in \{0, 1\}^* 1\} =
                   \{1, 4, 6, 9, 12, 14, 17, 19, 22, 25, ...\}
\end{eqnarray*}
\\
Let us look at the first few substitutions of $\sigma$:\\
\\
$\sigma^0(a) =$ \monoit{a}\\
$\sigma^1(a) =$ \monoit{ab}\\
$\sigma^2(a) =$ \monoit{aba}\\
$\sigma^3(a) =$ \monoit{abaab}\\
$\sigma^4(a) =$ \monoit{abaababa}

\paragraph{Theorem}
\emph{$\sigma^n = \sigma^{n - 1} \sigma^{n - 2}, n \in \mathbb{N}, n \ge 2$}

\paragraph{Proof} By induction.\\
Initial step:
$\sigma^2 = aba = \sigma^1 \sigma^0$.\\
Induction step: We have 
$\sigma^{n + 1} = \sigma(\sigma^n) = \sigma(\sigma^{n - 1} \sigma^{n - 2} = 
\sigma(\sigma^{n - 1}) \sigma(\sigma^{n - 2}) = \sigma^n \sigma^{n - 1}$.
\qed\\ 
\\
We write in column $j$ the Fibonacci expansion of $j$ from above to below.\\
\\
\monoit{a b a ab aba abaab ...}\\
\verb#0 1 1 11 111 11111#\\
\verb#    0 00 000 00000#\\
\verb#      01 001 00011#\\
\verb#         010 00100#\\
\verb#             01001#\\
\\
We see that the Fibonacci expansions of the integers $n$ with 
$F_k \le n < F_{k + 1}$ are all of length $k$ and we can deduce from the 
definition of the Fibonacci expansion strings that end with a 0 can
be extended in two ways: $...0 \rightarrow ...00, ...01$, and strings that
end with a 1 can only be extended in one way: $...1 \rightarrow ...10$ in a 1-1
correspondence with the fixed point.\\

\section*{Unknown territory}
Just for fun, look at the substitution $\sigma$ given by 
$\sigma(a) \rightarrow aba, \sigma(b) \rightarrow bb$. This looks like the 
Cantor substitution, but like the Fibonacci substitution it is not of fixed 
length.\\
\\
This is the associated automaton:\\
% Picture of non-complete Cantor automaton. {{{1
\begin{graph}(0, 3)(-4, -1.5)
  \graphnodecolour{1}
  \graphnodesize{1}
  \roundnode{s1}(-2, 0) \nodetext{s1}(0, 0){$a$}
  \roundnode{s2}(0, 0)  \nodetext{s2}(0, 0){$b$}

  \dirloopedge{s1}{50}(-1, 0) \freetext(-3.6, 0){0,2}
  \diredge{s1}{s2} \edgetext{s1}{s2}{1}
  \dirloopedge{s2}{50}(1, 0) \freetext(1.6, 0){0,1}

  \freetext(-2, -0.7){$\Uparrow$}
\end{graph}\\
%}}}1
If this automaton defines an enumeration system in base 3 then it has the 
following property: if $n_i = 1$ then $\not\exists (j > i) \{ n_j = 2\}$. This 
follows from the fact that this automaton recognises the language:
$\{0, 2\}^* \{\epsilon, (1\{0, 1\}^*)\}$.\\
Its first few elements are:
$\{0, 1, 2, 10, 11, 20, 21, 22, 100, 101, 110, 111, 200\}$ and we left out:
$\{12, 102, 112, 120, 121, 122\}$. Perhaps there is an explicit function that
maps this sequence to $\mathbb{N}$. If so (as in the Fibonacci case), we can
feed our automaton with it.\\
\\
In general we can always find the language associated with the automaton. And
we can always enumerate the words in this language (by length and
lexicographically). However, since in general we cannot give the $n$--th word
in the language a priory, it is all pretty useless.

\begin{thebibliography}{XX}
\bibitem{F1} Fogg page ...
\bibitem{F2} Fogg page ...
\end{thebibliography}
\end{document}
